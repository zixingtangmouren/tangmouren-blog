(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{368:function(t,s,a){"use strict";a.r(s);var n=a(45),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"å®ç°ä¸€ä¸ªç®€å•çš„-vue3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°ä¸€ä¸ªç®€å•çš„-vue3"}},[t._v("#")]),t._v(" å®ç°ä¸€ä¸ªç®€å•çš„ Vue3")]),t._v(" "),a("h2",{attrs:{id:"å‰è¨€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[t._v("#")]),t._v(" å‰è¨€")]),t._v(" "),a("p",[t._v("æœ€è¿‘è‡ªå·±å†™äº†ä¸€ä¸ªç®€æ˜“ç‰ˆçš„ Vue3 ç©ä¸€ç©ï¼Œå½“ç„¶å•¦ï¼Œé‡Œé¢æ²¡æœ‰ patch å’Œç¼–è¯‘çš„éƒ¨åˆ†ï¼ˆå› ä¸ºèƒ½åŠ›æœ‰é™ï¼‰ğŸ˜‚ï¼Œæ‰€ä»¥åƒåˆ†äº«ä¸€ä¸‹è‡ªå·±åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å­¦åˆ°çš„ä¸œè¥¿ã€‚è¯¥ç¯‡ä¸»è¦æ˜¯ä»¥å¦‚ä½•å®ç°ä¸€ä¸ªç®€å• Vue3 çš„æ–¹å¼ï¼Œæ¥è®²è§£æºç çš„è®¾è®¡å’ŒåŸºæœ¬åŸç†ã€‚")]),t._v(" "),a("h2",{attrs:{id:"è¦åšä»€ä¹ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è¦åšä»€ä¹ˆ"}},[t._v("#")]),t._v(" è¦åšä»€ä¹ˆ")]),t._v(" "),a("p",[t._v("åœ¨åšä¹‹å‰ï¼Œå…ˆæƒ³ä¸€ä¸‹è¦åšå•¥ï¼Œæ‰€ä»¥ç®€å•åˆ—äº†ä¸€ä¸ªæ¸…å•ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("ææ‡‚ setup é€‰é¡¹")]),t._v(" "),a("li",[t._v("å®ç°å“åº”å¼æ ¸å¿ƒ reactive å‡½æ•°")]),t._v(" "),a("li",[t._v("å®ç°å¼‚æ­¥é˜Ÿåˆ—çš„æœºåˆ¶")]),t._v(" "),a("li",[t._v("å®ç° effect å‡½æ•°")]),t._v(" "),a("li",[t._v("å®ç° watchï¼Œ computedï¼ŒwatchEffect å‡½æ•°")])]),t._v(" "),a("p",[t._v("è¿™äº›æ˜¯æˆ‘åœ¨å¤§è‡´çœ‹äº†æºç ä¹‹åï¼Œæ€»ç»“å‡ºæ¥çš„ Vue3 ä¸»è¦éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¼šç»å¸¸æ¥è§¦åˆ°çš„éƒ¨åˆ†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥å®Œæˆè¿™äº›æ¸…å•ï¼Œå¹¶åœ¨ä¸€æ­¥æ­¥å®ç°ä¸­ï¼Œææ‡‚ Vue3 çš„å¤§è‡´åŸç†ã€‚")]),t._v(" "),a("h2",{attrs:{id:"åˆå§‹åŒ–é€‰é¡¹-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆå§‹åŒ–é€‰é¡¹-setup"}},[t._v("#")]),t._v(" åˆå§‹åŒ–é€‰é¡¹ setup")]),t._v(" "),a("p",[t._v("è¿™é‡Œæˆ‘å…ˆæ¥çœ‹ä¸€ä¸‹ Vue3 ä¸­ setup çš„ç”¨æ³•ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h1 @click"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onClick"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" msg "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h1"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" doubleAge "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" defineComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reactive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" onBeforeMount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" computed "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'App'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  props"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'tangmouren'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      age"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" doubleAge "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onClick")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onBeforeMount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      doubleAge"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      onClick\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("æˆ‘ä»¬æ¥åˆ†æå®ƒæ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚")]),t._v(" "),a("p",[t._v("é¦–å…ˆå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚å®ƒä¼šå°†ç»„ä»¶ä¸­éœ€è¦çš„æ•°æ®å’Œæ–¹æ³•é€šè¿‡ä¸€ä¸ªå¯¹è±¡è¿”å›ã€‚è¿™ä¸ªæœ‰ç‚¹åƒ Vue2 ä¸­çš„ data é€‰é¡¹ï¼Œç”¨å‡½æ•°è¿”å›ä¸€ä¸ªæ•°æ®å¯¹è±¡ï¼Œå…¶å®å®ƒä»¬çš„é“ç†ä¸€è‡´ï¼Œéƒ½æ˜¯å°†ç»„ä»¶éœ€è¦çš„ä¸œè¥¿ return å‡ºå»ã€‚æ‰€ä»¥åœ¨ç»„ä»¶åˆå§‹åŒ–æ—¶ä¼šæ‰§è¡Œè¿™äº›å‡½æ•°ï¼Œè·å–è¿”å›çš„å¯¹è±¡å¹¶è¿›è¡Œç›¸å…³å¤„ç†ï¼Œæœ€åç»Ÿä¸€æŒ‚è½½è‡³ç»„ä»¶å®ä¾‹ä¸Šã€‚")]),t._v(" "),a("p",[t._v("è¿™é‡Œå¯ä»¥ç®€å•å®ç°ä¸€ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" setup "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" setupResult "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" setupResult\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ç„¶åç»„ä»¶æ¸²æŸ“çš„æ—¶å€™å°±å¯ä»¥é€šè¿‡è¿™ä¸ª ctx è®¿é—®åˆ°è¿™äº›æ•°æ®å’Œæ–¹æ³•äº†ï¼Œè¿™é‡Œå±•ç¤ºä¸€ä¸ª Vue3 æ¨¡æ¿ç¼–è¯‘çš„ä¾‹å­ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h1 @click"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onClick"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" msg "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h1"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" doubleAge "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¼šè¢«ç¼–è¯‘æˆï¼š")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("_ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _cache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" $props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" $setup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" $data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" $options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_openBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_createBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"div"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_createVNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"h1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" onClick"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" _ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onClick "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_toDisplayString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* TEXT, PROPS */")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onClick"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_createVNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"h2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_toDisplayString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* TEXT */")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_createVNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"h2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_toDisplayString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* TEXT */")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_createVNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"h2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_toDisplayString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("doubleAge"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* TEXT */")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"å“åº”å¼æ ¸å¿ƒ-reactive-å‡½æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å“åº”å¼æ ¸å¿ƒ-reactive-å‡½æ•°"}},[t._v("#")]),t._v(" å“åº”å¼æ ¸å¿ƒ reactive å‡½æ•°")]),t._v(" "),a("p",[t._v("å‰é¢å’±ä»¬å·²ç»å°è¯•èº«æ‰‹çš„å†™äº†å‡ è¡Œä»£ç äº†ï¼Œè¿™ä¸ªâ€œå®ä¼Ÿâ€çš„å·¥ç¨‹å·²ç»å¼€å§‹äº†ã€‚æ¥ä¸‹æ¥ï¼Œå°±æ˜¯ Vue ä¸­æœ€ä¸ºæ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯æˆ‘è®¤ä¸ºä»»ä½•ä¸€ä¸ª Vue å¼€å‘è€…å¿…é¡»æ‡‚çš„éƒ¨åˆ†ã€‚")]),t._v(" "),a("h3",{attrs:{id:"è€ç”Ÿå¸¸è°ˆçš„å“åº”å¼åŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è€ç”Ÿå¸¸è°ˆçš„å“åº”å¼åŸç†"}},[t._v("#")]),t._v(" è€ç”Ÿå¸¸è°ˆçš„å“åº”å¼åŸç†")]),t._v(" "),a("p",[t._v("å…ˆæ¥æ¢³ç†ä¸€ä¸‹ Vue ä¸€ä¸ªå…³é”®çš„ç†å¿µ --- å“åº”å¼è®¾è®¡ã€‚åœ¨å“åº”å¼åŸç†ä¸­æœ€é‡è¦çš„ä¸‰è¦ç´ ï¼Œå°± "),a("strong",[t._v("Watcherï¼Œ Depï¼ŒObserverã€‚")]),t._v(" æ­£æ˜¯ç”±è¿™ä¸‰ä¸ªè¦ç´ å®ç°äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆå‘å¸ƒè€…/è®¢é˜…è€…æ¨¡å¼ï¼‰ã€‚é‚£è¿™ä¸ªæ¨¡å¼ï¼Œåœ¨ Vue2/Vue3 ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Œå’±ä»¬å…ˆæ¥ææ‡‚è¿™å‡ ä¸ªé—®é¢˜ï¼š")]),t._v(" "),a("p",[t._v("åœ¨æ¡†æ¶ä¸­ï¼Œè°æ˜¯å‘å¸ƒè€…ï¼Œè°æ˜¯è®¢é˜…è€…ï¼š"),a("strong",[t._v("å¯¹æ•°æ®ï¼ˆdataï¼‰è¿›è¡Œæ‹¦æˆªçš„é‚£ä¸ªå¯¹è±¡ï¼Œå°±æ˜¯å‘å¸ƒè€…ã€‚åŒ…å«ä¸€ä¸ªä»»åŠ¡ï¼ˆå‡½æ•°ï¼‰çš„å¯¹è±¡/å‡½æ•°ï¼Œå°±æ˜¯è®¢é˜…è€…(Vue2 æ˜¯ Watcherï¼ŒVue3 æ˜¯ Effect)ã€‚")])]),t._v(" "),a("p",[t._v("å‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´çš„å…³ç³»ï¼š"),a("strong",[t._v("å‘å¸ƒè€…ä¼šå»æ”¶é›†ç›¸å…³çš„è®¢é˜…è€…ï¼Œä¸€æ—¦å‘å¸ƒè€…æœ‰åŠ¨ä½œï¼Œå°±ä¼šé€šçŸ¥æ”¶é›†åˆ°çš„è®¢é˜…è€…æ‰§è¡Œä»»åŠ¡ã€‚")])]),t._v(" "),a("p",[t._v("å‘å¸ƒè€…æ˜¯å¦‚ä½•æ”¶é›†è®¢é˜…è€…çš„ï¼š"),a("strong",[t._v("åœ¨æ¸²æŸ“æ—¶ä¼šåˆ›å»º VNode å¹¶è¯»å–æ•°æ®ï¼Œæ‰€ä»¥å‘å¸ƒè€…çš„æŸä¸ªæ•°æ®ä¸€æ—¦è¢«è®¿é—®ï¼Œå®ƒå°±ä¼šæŠŠå½“å‰æ¿€æ´»çš„è®¢é˜…è€…å­˜åˆ°å¯¹åº”çš„ Dep ä¸­ï¼ˆè¿™è¿‡ç¨‹å«ä¾èµ–æ”¶é›†ï¼‰ã€‚")])]),t._v(" "),a("p",[t._v("å…³äºä¾èµ–æ”¶é›†åœ¨è¯»å–æ•°æ®çš„è¿‡ç¨‹ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ä¸Šé¢å…³äº"),a("code",[t._v("template")]),t._v("ç¼–è¯‘æˆ"),a("code",[t._v("render")]),t._v("å‡½æ•°çš„ä»£ç ï¼ˆè¿™ä¸ªç¼–è¯‘è¿‡ç¨‹æ˜¯ç”± vue-loader å¤„ç†çš„ï¼‰ã€‚å› ä¸ºåˆ›å»º"),a("code",[t._v("VNode")]),t._v("éœ€è¦è¯»å–ç›¸å…³æ•°æ®ï¼Œæ‰€ä»¥ä¸€æ—¦è¯»å–æ•°æ®å°±ä¼šè§¦å‘å¯¹åº”çš„ä¾èµ–æ”¶é›†ã€‚")]),t._v(" "),a("h3",{attrs:{id:"vue2-å’Œ-vue3-åœ¨å®ç°ä¸Šçš„å·®å¼‚"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue2-å’Œ-vue3-åœ¨å®ç°ä¸Šçš„å·®å¼‚"}},[t._v("#")]),t._v(" Vue2 å’Œ Vue3 åœ¨å®ç°ä¸Šçš„å·®å¼‚")]),t._v(" "),a("p",[t._v("Vue3 åœ¨å“åº”å¼è®¾è®¡ä¸Šè‚¯å®šæ˜¯ä¸ä¼šå‘ç”Ÿå¤ªå¤šå˜åŒ–çš„ï¼Œæ‰€ä»¥å¤§è‡´é€»è¾‘åŸºæœ¬è·Ÿ Vue2 ä¸€è‡´ï¼Œæ¢æ±¤ä¸æ¢è¯ã€‚ä½†æ˜¯åœ¨ Vue3 çš„éƒ¨åˆ†æ ¸å¿ƒé€»è¾‘ä¸Šï¼Œè¿˜æ˜¯åšå‡ºäº†ä¸€å®šçš„ä¼˜åŒ–å’Œæ”¹å˜ã€‚")]),t._v(" "),a("p",[t._v("ä¸»è¦å¦‚ä¸‹ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("åœ¨ Vue2 ä½¿ç”¨çš„"),a("code",[t._v("Object.defineProperty")]),t._v("å®ç°çš„æ•°æ®æ‹¦æˆªï¼Œè€Œåœ¨ Vue3 ä¸­åˆ™æ˜¯é‡‡ç”¨"),a("code",[t._v("Proxy")]),t._v("å»è¿›è¡Œæ•°æ®çš„ä»£ç†ã€‚")]),t._v(" "),a("li",[a("code",[t._v("Dep")]),t._v("ä¹Ÿä¸å†å­˜å‚¨åœ¨é—­åŒ…ä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨"),a("code",[t._v("WeakMapï¼ŒMapï¼ŒSet")]),t._v("è¿™äº›æ•°æ®ç»“æ„æ¥å…¨å±€çš„å­˜å‚¨ã€‚")]),t._v(" "),a("li",[t._v("ä¹‹å‰æ˜¯é‡‡ç”¨"),a("code",[t._v("Watcher")]),t._v("å»å®ç°è®¢é˜…è€…ï¼Œåœ¨ Vue3 åˆ™æ˜¯é‡‡ç”¨"),a("code",[t._v("effect")]),t._v("è¿™ç§å‰¯ä½œç”¨å‡½æ•°çš„å½¢å¼ã€‚æ‰€ä»¥åœ¨ä¾èµ–æ”¶é›†çš„è¿‡ç¨‹ä¸­ï¼Œæ”¶é›†çš„ä¸å†æ˜¯"),a("code",[t._v("Watcher")]),t._v("è€Œæ˜¯"),a("code",[t._v("effect")]),t._v("å‡½æ•°ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"å®ç°-observer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°-observer"}},[t._v("#")]),t._v(" å®ç° Observer")]),t._v(" "),a("p",[t._v("ç†æ¸…åŸç†ï¼Œå¯ä»¥å¼€å§‹å¹²æ­£äº‹äº†ã€‚é¦–å…ˆæ¥å®ç°ä¸‰å¤§è¦ç´ ä¸­çš„ç¬¬ä¸€ä½é€‰æ‰‹---è§‚å¯Ÿè€…ã€‚")]),t._v(" "),a("p",[t._v("å®ƒæœ‰ä»€ä¹ˆåŠŸèƒ½ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("å¯¹ä¸€ä¸ªæ•°æ®è¿›è¡Œä»£ç†ï¼Œæ‹¦æˆªè¯»å†™å¢åˆ ç­‰æ“ä½œï¼ˆProxy ä¸ä»…ä»…åªèƒ½æ‹¦æˆªè¯»å’Œå†™ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å» MDN è¯¦ç»†å»äº†è§£ä¸€ä¸‹ï¼Œæœ¬ç¯‡åªè€ƒè™‘è¯»å†™çš„æƒ…å†µï¼‰")]),t._v(" "),a("li",[t._v("è¢«è¯»çš„æ—¶å€™ï¼Œæ”¶é›†å½“å‰æ¿€æ´»çš„"),a("code",[t._v("effect")]),t._v("å‡½æ•°å­˜å…¥"),a("code",[t._v("Dep")]),t._v("ä¸­")]),t._v(" "),a("li",[t._v("å½“è¢«ä¿®æ”¹æ—¶ï¼Œæ‰§è¡Œ"),a("code",[t._v("Dep")]),t._v("ä¸­æ‰€æœ‰çš„"),a("code",[t._v("effect")]),t._v("å‡½æ•°")])]),t._v(" "),a("p",[t._v("åœ¨"),a("code",[t._v("Composition API")]),t._v("ä¸­ï¼Œæä¾›äº†ä¸€ä¸ª"),a("code",[t._v("reactive")]),t._v("å‡½æ•°æ¥å®ç° Vue çš„å“åº”å¼ç³»ç»Ÿï¼Œå°†ä¼ å…¥çš„å¯¹è±¡ç”¨ proxy è¿›è¡Œå“åº”å¼å¤„ç†ï¼Œå¹¶å°†å…¶å¯¹è±¡çš„ä»£ç†è¿”å›ã€‚æ‰€ä»¥è¿™é‡Œå…ˆæ¥å†™ä¸€ä¸ª"),a("code",[t._v("reactive")]),t._v("å‡½æ•°ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// proxyå¯¹åº”çš„handler")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" handler "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  get"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" getter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  set"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" setter\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" target "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'object'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" target\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createReactiveObject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createReactiveObject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯¹å½“å‰è¿™ä¸ªå¯¹è±¡è¿›è¡Œå“åº”å¼çš„å¤„ç†å¹¶è¿”å›ä»£ç†")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Proxy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" handler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("è¿™é‡Œä¸éš¾çœ‹å‡ºï¼Œåˆ›å»ºçš„å‘å¸ƒè€…å°±æ˜¯ä¸€ä¸ª Proxyã€‚Proxy ä¼šå¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œè®¿é—®æ‹¦æˆªï¼Œå› ä¸ºç›®å‰åªè€ƒè™‘å¯¹æ•°æ®è¿›è¡Œè¯»å’Œå†™çš„æƒ…å†µï¼Œæ‰€ä»¥åªå®ç° set å’Œ get çš„å…·ä½“é€»è¾‘ã€‚")]),t._v(" "),a("h4",{attrs:{id:"get"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get"}},[t._v("#")]),t._v(" get")]),t._v(" "),a("p",[t._v("get çš„ä¸»è¦æˆªé€»è¾‘æ˜¯æ•°æ®è¢«è®¿é—®æ—¶ï¼Œå…ˆè¯»å–ç›®æ ‡å¯¹è±¡çš„å€¼ï¼Œå†ä¸ºå½“è®¿é—®çš„ key æ”¶é›†"),a("code",[t._v("activeEffect")]),t._v("å¹¶å­˜å…¥å¯¹åº”"),a("code",[t._v("Dep")]),t._v("ä¸­ã€‚")]),t._v(" "),a("p",[t._v("è¿™é‡Œå…ˆæ¥å®ç°è¯»å–å€¼çš„é€»è¾‘ï¼ˆæç¤ºï¼šç•™æ„ä¸€ä¸‹è®¿é—®çš„å€¼æ˜¯å¯¹è±¡çš„æ—¶å€™ï¼‰ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“å‰æ¿€æ´»çš„effect")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" activeEffect\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¯»å–æ‹¦æˆª")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¯»å–ç›®æ ‡å¯¹è±¡å¯¹åº”å±æ€§çš„å€¼")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®©è¿™ä¸ªkeyæ”¶é›†å½“å‰æ¿€æ´»çš„effect")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("track")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™é‡Œè¦è€ƒè™‘è®¿é—®çš„å±æ€§å¯èƒ½æ˜¯å¯¹è±¡çš„æƒ…å†µ")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// éœ€è¦è¿›ä¸€æ­¥è¿›è¡Œå“åº”å¼å¤„ç†")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™é‡Œä¹Ÿæ˜¯Vue3çš„ä¸€ä¸ªä¼˜åŒ–ï¼Œä¸‹æ–‡ä¼šç»†è¯´")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" res "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'object'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" res\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("é‡ç‚¹æ˜¯ track çš„é€»è¾‘ï¼Œå®ƒæ˜¯ä¾èµ–æ”¶é›†çš„å…³é”®ï¼Œå®ƒä¼šæ ¹æ®å½“å‰å¯¹è±¡è¢«è®¿é—®çš„ key æ‰¾åˆ°å¯¹åº” depï¼Œç„¶åå°†å½“å‰çš„"),a("code",[t._v("activeEffect")]),t._v("æ”¶é›†è¿›å»ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ”¶é›†ä¾èµ–")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("track")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("activeEffect "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰¾åˆ°å½“å‰å¯¹è±¡çš„depé›†åˆ")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" depsMap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" targetMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœæ²¡æœ‰å°±åˆ›å»ºä¸€ä¸ªæ–°çš„depé›†åˆ")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("depsMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    targetMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("depsMap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¯ä¸ªkeyéƒ½æœ‰è‡ªå·±å¯¹åº”çš„dep")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" dep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" depsMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    depsMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("has")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("activeEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¿å­˜å½“å‰çš„activeEffect")]),t._v("\n    dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("activeEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ä¸Šé¢çš„ä»£ç å°±åŸºæœ¬å®ç°äº†æ•°æ®è¢«è®¿é—®æ—¶æ”¶é›†ä¾èµ–çš„åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œè¿˜æœ‰ä¸¤ä¸ªç‚¹éœ€è¦è¯´æ˜ä¸€ä¸‹ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("ä¸€ä¸ªæ˜¯ä»£ç ä¸­ç”¨åˆ°çš„"),a("code",[t._v("targetMap, depsMap, dep")]),t._v("è¿™å‡ ä¸ªæ•°æ®ç»“æ„")]),t._v(" "),a("li",[t._v("è®¿é—®çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™çš„å¤„ç†")])]),t._v(" "),a("p",[t._v("å…ˆæ¥çœ‹ç¬¬ä¸€ä¸ªç‚¹ï¼Œå‰é¢ä¹Ÿè¯´åˆ°ï¼ŒVue3 åœ¨å¯¹ Dep çš„å­˜å‚¨è¿›è¡Œäº†æ”¹å˜ï¼Œæ‰€ä»¥ä½ å…ˆæš‚æ—¶è®¤ä¸ºè¿™å‡ ä¸ªæ•°æ®ç»“æ„åªæ˜¯ç”¨æ¥å‚¨å­˜å’ŒæŸ¥æ‰¾ dep çš„ã€‚dep çš„å®ç°ï¼Œå°†æ”¾åœ¨åé¢æ¥è®²è§£ã€‚")]),t._v(" "),a("p",[t._v("ç„¶åæ˜¯ç¬¬äºŒç‚¹ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ª"),a("strong",[t._v("é‡ç‚¹")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("ä¸ºä»€ä¹ˆå½“è®¿é—®çš„ key å¯¹åº”çš„ value æ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œè¦åšä¸ä¸€æ ·çš„å¤„ç†å‘¢ï¼Ÿ")]),t._v(" "),a("p",[t._v("è¿™é‡Œè¯´ä¸€ä¸‹ Vue2 æ˜¯å¦‚ä½•å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œå“åº”å¼å¤„ç†ã€‚ Vue2 å®ƒæä¾›äº†ä¸€ä¸ª"),a("code",[t._v("data")]),t._v("é€‰é¡¹ï¼Œè¿™ä¸ªé€‰é¡¹ä¸€èˆ¬éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ–è€…æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡çš„å‡½æ•°ï¼Œåœ¨ Vue2 ä¸­å“åº”å¼å¤„ç†ä¼šå°†"),a("code",[t._v("data")]),t._v("æä¾›çš„è¿™ä¸ªå¯¹è±¡å»æ·±åº¦çš„éå†ï¼Œä¸€æ—¦æŸä¸ªå±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡å°±ä¼šç»§ç»­å¾€ä¸‹é€’å½’ï¼Œå»ä½¿ç”¨"),a("code",[t._v("Object.defineProperty")]),t._v("è¿™ API å»è¿›è¡Œæ‹¦æˆªå¤„ç†ã€‚å¤§è‡´å®ç°å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("observer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("keys")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'object'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç»§ç»­é€’å½’å¤„ç†")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("observer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("è¿™ç§æ–¹å¼ï¼Œè¿™å°±ä¼šå­˜åœ¨ä¸¤ä¸ªå¾ˆå¤§çš„æ€§èƒ½é—®é¢˜ï¼š")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("å¦‚æœå¯¹è±¡çš„å±‚æ¬¡å¾ˆæ·±ï¼Œé‚£é€’å½’çš„è¿‡ç¨‹æ˜¯å¾ˆæ¶ˆè€—æ€§èƒ½ã€‚ç¬¬ä¸€ä½¿ç”¨"),a("code",[t._v("Object.defineProperty")]),t._v("è¿™ä¸ª API éœ€è¦éå†å¯¹è±¡çš„æ¯ä¸€ä¸ª key è¿›è¡Œå¤„ç†ï¼Œç¬¬äºŒå¦‚æœè¿™ä¸ª key å¯¹åº”çš„å€¼åˆæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆåˆéœ€è¦è¿›è¡Œé€’å½’çš„éå†å¤„ç†ã€‚")])]),t._v(" "),a("li",[a("p",[t._v("è¿™æ ·å…¨é¢çš„é€’å½’å“åº”å¼å¤„ç†ï¼Œè¿˜ä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯å¦‚æœå¯¹è±¡çš„å±‚æ¬¡å¾ˆæ·±ï¼Œä½†æ˜¯é‡Œé¢å¾ˆå¤šçš„å±æ€§éƒ½æ²¡æœ‰åœ¨"),a("code",[t._v("template")]),t._v("ä¸­ä½¿ç”¨åˆ°ï¼Œé‚£ç»™è¿™äº›æ²¡æœ‰ä½¿ç”¨åˆ°çš„ key å¢åŠ çš„ä¾èµ–æ”¶é›†ï¼Œå’Œé€šçŸ¥è®¢é˜…è€…çš„èƒ½åŠ›ï¼Œå°±æˆäº†æ¯«æ— æ„ä¹‰çš„æ“ä½œã€‚")])])]),t._v(" "),a("p",[t._v("è¿™é‡Œè¯´ä¸€ä¸ªæˆ‘åœ¨å·¥ä½œä¸­çœ‹åˆ°çš„ä¾‹å­ï¼š")]),t._v(" "),a("p",[t._v("åœ¨å·¥ä½œä¸­ç»å¸¸ä¼šä½¿ç”¨åˆ°ä¸€äº›ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œåƒ"),a("code",[t._v("Echart, Antv")]),t._v("è¿™äº›æ•°æ®å¯è§†åŒ–æ¡†æ¶ï¼Œè¿˜æœ‰"),a("code",[t._v("BMap, AMap")]),t._v("è¿™äº›åœ°å›¾æ¡†æ¶ã€‚ä½†æ˜¯æˆ‘å‘ç°æˆ‘ä»¬å…¬å¸æœ‰çš„å°ä¼™ä¼´ï¼Œå°±ä¼šä¸å°å¿ƒåšä¸€ä¸ªè¿™æ ·çš„äº‹æƒ…ï¼Œæ¯”å¦‚ä»–åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ä¸€ä¸ªå¯è§†åŒ–å›¾è¡¨ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Chart "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@antv/g2'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'About'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      barChart"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mounted")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™é‡Œç›´æ¥å°†åˆ›å»ºå¥½çš„å›¾è¡¨å®ä¾‹èµ‹å€¼ç»™äº†dataé‡Œé¢çš„barChart")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("barChart "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Chart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      container"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'container'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      width"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      height"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™é‡Œæ¥è¾“å‡ºçœ‹ä¸€ä¸‹")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("barChart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" year"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1951 å¹´'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sales"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("38")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" year"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1952 å¹´'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sales"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" year"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1956 å¹´'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sales"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("61")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" year"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1957 å¹´'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sales"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("145")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("barChart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("barChart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("scale")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sales'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      nice"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("barChart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tooltip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      showMarkers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("barChart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("interaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'active-region'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("barChart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("position")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'year*sales'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("barChart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("çœ‹ä¼¼è¿™æ ·çš„å†™æ³•å¥½åƒæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æ­¤æ—¶æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹"),a("code",[t._v("barChart")]),t._v("çš„è¾“å‡ºï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d5f39849256841d4a0343c649885acf7~tplv-k3u1fbpfcp-watermark.image",alt:"1619682666(1).jpg"}})]),t._v(" "),a("p",[t._v("ä½ å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªå¯¹è±¡å›¾è¡¨å®ä¾‹ä¸­æ‰€æœ‰çš„å±æ€§éƒ½è¢«è¿›è¡Œäº†å“åº”å¼å¤„ç†ã€‚ä½ å¯ä»¥æƒ³ä¸€ä¸‹ï¼Œå¯¹è¿™ä¹ˆåºå¤§çš„ä¸€ä¸ªå¯¹è±¡è¿›è¡Œé€’å½’çš„å“åº”å¼å¤„ç†ï¼Œç„¶åé‡Œé¢çš„æ•°æ®åœ¨é¡µé¢ä¸Šä¸€ä¸ªéƒ½ç”¨ä¸åˆ°ï¼Œè¿™éš¾é“ä¸æ˜¯ä¸€ç§æ€§èƒ½çš„æµªè´¹å—ï¼Ÿå½“ç„¶è¿™ä¹Ÿåªæ˜¯ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ç›¸ä¿¡å¤§éƒ¨åˆ†çš„äººåº”è¯¥ä¸ä¼šçŠ¯è¿™ç§é”™è¯¯ï¼Œå› ä¸ºå¦‚æœä¸éœ€è¦å“åº”å¼çš„æ•°æ®ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦å†™åœ¨"),a("code",[t._v("data")]),t._v("ä¸­ã€‚")]),t._v(" "),a("p",[t._v("ä½†æ˜¯åœ¨ Vue3 ä¸­å“åº”å¼å¤„ç†çš„æ–¹å¼å°±æœ‰æ‰€ä¸åŒï¼Œ"),a("code",[t._v("reactive")]),t._v("å¹¶ä¸ä¼šä¸€å¼€å§‹å°±è¿›è¡Œæ·±åº¦çš„å¤„ç†ï¼Œè€Œæ˜¯åªå¯¹ç¬¬ä¸€å±‚è¿›è¡Œä»£ç†ã€‚å¯¹äºæ·±å±‚çš„å¯¹è±¡ï¼Œå®ƒçš„å“åº”å¼å¤„ç†æ˜¯å‘ç”Ÿåœ¨ get ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ·±å±‚å¯¹è±¡çš„æ²¡æœ‰è¢«è®¿é—®ï¼Œå®ƒå°±æ°¸è¿œä¸ä¼šè¢«å“åº”å¼å¤„ç†çš„ï¼Œè¿™ç§åšæ³•å°±å¤§å¤§æå‡äº†æ€§èƒ½ï¼ŒèŠ‚çœäº†ä¸å¿…è¦çš„è¿è¡Œå¼€é”€ã€‚")]),t._v(" "),a("p",[t._v("ä¸¾ä¸ªä¾‹å­ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åœ¨templateä¸­")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åœ¨setupä¸­å£°æ˜ä¸€ä¸ªå“åº”å¼å¯¹è±¡")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    num"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    age"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    person"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("å› ä¸ºåœ¨æ¨¡æ¿ä¸­æ²¡æœ‰è®¿é—®"),a("code",[t._v("state.person.a")]),t._v("ï¼Œæ‰€æœ‰"),a("code",[t._v("person")]),t._v("è¿™ä¸ªå¯¹è±¡ä¸ä¼šè¢«å¤„ç†æˆå“åº”å¼ï¼Œå°±ç®—ä½ å¦‚ä½•ä¿®æ”¹å®ƒçš„å€¼ï¼Œä¹Ÿä¸ä¼šè§¦å‘ä»€ä¹ˆäº‹ä»¶ã€‚")]),t._v(" "),a("h4",{attrs:{id:"set"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#set"}},[t._v("#")]),t._v(" set")]),t._v(" "),a("p",[t._v("ä¾èµ–æ”¶é›†çš„èƒ½åŠ›å·²ç»å®ç°äº†ï¼Œç°åœ¨å†æ¥æå®šé€šçŸ¥è®¢é˜…è€…çš„é€»è¾‘ã€‚å› ä¸ºå‘å¸ƒè€…å·²ç»æŠŠç›¸å…³çš„è®¢é˜…è€…æ”¶é›†åˆ°å¯¹åº”çš„ dep é˜Ÿåˆ—é‡Œé¢äº†ï¼Œæ‰€ä»¥é€šçŸ¥çš„é€»è¾‘ï¼Œæ— éå°±æ˜¯æ‰¾åˆ°å¯¹åº”çš„ dep ç„¶åé€ä¸€å–å‡ºé‡Œé¢"),a("code",[t._v("effect")]),t._v("å‡½æ•°å»æ‰§è¡Œã€‚")]),t._v(" "),a("p",[t._v("ä»£ç å®ç°ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¿®æ”¹å€¼")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è§¦å‘æ”¶é›†åˆ°çš„effectçš„æ‰§è¡Œ")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("trigger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" res\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("trigger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰¾åˆ°depé›†åˆ")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" depsMap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" targetMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("depsMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰¾åˆ°å¯¹åº”çš„dep")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" depsMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("effect")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœeffectå­˜åœ¨ä¸€ä¸ªè°ƒåº¦çš„æœºåˆ¶ï¼Œå°±ä½¿ç”¨è¿™ä¸ªè°ƒåº¦çš„æ–¹å¼å»æ‰§è¡Œ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("effect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scheduler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      effect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("scheduler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("effect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç›´æ¥æ‰§è¡Œè¿™ä¸ª`effect`")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("è¿™ä¸ª set æ‰§è¡Œè¿‡ç¨‹å°±æ˜¯å…ˆä¿®æ”¹å€¼ï¼Œç„¶åæ‰§è¡Œ trigger å»æ‰¾åˆ°å½“å‰ key å¯¹åº”çš„ depï¼Œæœ€åéå†æ‰§è¡Œ dep ä¸­çš„è®¢é˜…è€…"),a("code",[t._v("effect")]),t._v("ã€‚")]),t._v(" "),a("h4",{attrs:{id:"ç®€å•è¯•ä¸€ä¸‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç®€å•è¯•ä¸€ä¸‹"}},[t._v("#")]),t._v(" ç®€å•è¯•ä¸€ä¸‹")]),t._v(" "),a("p",[t._v("ä¸Šé¢å“åº”å¼å¤„ç†çš„å¤§éƒ¨åˆ†é€»è¾‘å·²ç»å®ç°äº†ï¼Œç°åœ¨æ¥ç®€å•æµ‹è¯•ä¸€ä¸‹ã€‚æˆ‘ä»¬å‡è®¾å½“å‰çš„"),a("code",[t._v("activeEffect")]),t._v("æ˜¯ä¸€ä¸ª"),a("code",[t._v("update")]),t._v("æ¸²æŸ“æ›´æ–°å‡½æ•°ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("activeEffect")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'æ¸²æŸ“è§†å›¾ï¼'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™é‡Œæ˜¯é˜²æ­¢åœ¨è§¦å‘setterçš„æ—¶å€™ï¼Œæ²¡æœ‰è¿™ä¸ªoptionsæŠ¥é”™")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åé¢å®ç°effectçš„æ—¶å€™ï¼Œä¼šç”¨åˆ°è¿™ä¸ªé€‰é¡¹")]),t._v("\nactiveEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ç„¶åæ¥åˆ›å»ºä¸€ä¸ªç»„ä»¶ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      num"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      person"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      state\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¨¡æ‹Ÿrenderè®¿é—®æ•°æ®çš„è¿‡ç¨‹")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¿®æ”¹æ•°æ®")]),t._v("\nvm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("666")]),t._v("\nvm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("999")]),t._v("\n")])])]),a("p",[t._v("æ¥çœ‹ä¸€ä¸‹ç»“æœï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/99eea96a04194f1caaf49461197d0216~tplv-k3u1fbpfcp-watermark.image",alt:"sds.jpg"}})]),t._v(" "),a("p",[t._v("niceï¼Œç»„ä»¶ä¸­çš„æ•°æ®æˆåŠŸçš„æ”¶é›†åˆ°äº†"),a("code",[t._v("effect")]),t._v("ï¼Œå¹¶ä¸”åœ¨è®¿é—®çš„æ—¶å€™èƒ½å¤Ÿè§¦å‘ã€‚")]),t._v(" "),a("p",[t._v("å†æ¥æµ‹è¯•ä¸€ä¸ªæƒ…å†µï¼Œå‡å¦‚æ·±å±‚å¯¹è±¡çš„æ•°æ®è¦æ˜¯æ²¡æœ‰åœ¨"),a("code",[t._v("template")]),t._v("ä¸­è¢«ä½¿ç”¨åˆ°ï¼Œæ˜¯å¦ä¼šè¢«å¤„ç†æˆå“åº”å¼çš„å‘¢ï¼Ÿä¸ºäº†èƒ½å‡†ç¡®çš„çœ‹åˆ°æ˜¯å“ªä¸ªæ•°æ®è§¦å‘çš„æ›´æ–°ï¼Œæˆ‘ä»¬ç¨å¾®æ”¹å˜ä¸€ä¸‹åŸæœ‰çš„ä»£ç ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ”¹å˜ä¸€ä¸‹updateå‡½æ•°")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("activeEffect")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(" --- è§¦å‘çš„æ›´æ–°è§†å›¾ï¼")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nactiveEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// triggeråœ¨æ‰§è¡Œeffectçš„é€»è¾‘ä¹Ÿç¨å¾®æ”¹ä¸€ä¸‹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("effect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scheduler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¼ é€’å½“å‰çš„keyçš„ç»™update")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ä¾‹å­ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™é‡Œåªå•ç‹¬çš„å»è®¿é—®num")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¿®æ”¹æ•°æ®")]),t._v("\nvm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("666")]),t._v("\nvm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("999")]),t._v("\n")])])]),a("p",[t._v("å†æ¥çœ‹ä¸€ä¸‹ç»“æœï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/530b2644f11543529d3f75b03c65a50e~tplv-k3u1fbpfcp-watermark.image",alt:"6sd8sd.png"}})]),t._v(" "),a("p",[t._v("éå¸¸çš„ niceï¼Œperson æ²¡æœ‰è¢«è®¿é—®ï¼Œå®ƒå¹¶æ²¡æœ‰è¢«å“åº”å¼å¤„ç†ï¼Œæ‰€ä»¥ä¸èƒ½è§¦å‘"),a("code",[t._v("update")]),t._v("å‡½æ•°ã€‚")]),t._v(" "),a("h3",{attrs:{id:"å®ç°-dep"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°-dep"}},[t._v("#")]),t._v(" å®ç° Dep")]),t._v(" "),a("p",[t._v("Vue ä¸­çš„ä¸‰å¤§é‡è¦ç´ ï¼Œå·²ç»å®ç°äº†ä¸€ä¸ª"),a("code",[t._v("Observer")]),t._v("ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å®ç°ç”¨æ¥å­˜æ”¾è®¢é˜…è€…çš„åœ°æ–¹ --- Depã€‚")]),t._v(" "),a("p",[t._v("åœ¨å¼€å§‹è¿™ä¸ªå°èŠ‚çš„æ—¶å€™ï¼Œä½ é¦–å…ˆå¾—å¯¹"),a("code",[t._v("WeakMap, Map, Set")]),t._v("è¿™å‡ ä¸ªæ•°æ®ç»“æ„æœ‰æ‰€äº†è§£ã€‚å…ˆæ¥å›é¡¾ä¸€ä¸‹ Vue2 æ˜¯æ€ä¹ˆå­˜è¿™ä¸ª Dep çš„ï¼Œåœ¨å¯¹è±¡çš„æ¯ä¸ª key è¿›è¡Œæ‹¦æˆªå¤„ç†çš„æ—¶å€™ï¼Œåœ¨å‡½æ•°å†…éƒ¨åˆ›å»ºä¸€ä¸ª depï¼Œä¹Ÿå°±æ˜¯å°†æ¯ä¸€ä¸ª key å¯¹åº”çš„ dep ä¿å­˜åœ¨ä¸€ä¸ªå‡½æ•°é—­åŒ…ä¸­ï¼Œå¤§è‡´å®ç°å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åœ¨å¤„ç†æ¯ä¸ªkeyçš„æ—¶å€™ï¼Œåœ¨å‡½æ•°å†…éƒ¨åˆ›å»ºä¸€ä¸ªdep")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Dep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'object'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("observer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("åœ¨ Vue3 ä¸­ï¼Œæˆ‘è§‰å¾— Dep å®ç°å°±æ¯” Vue2 æ¸…æ™°ç®€å•å¾ˆå¤šã€‚å®ƒå…¶å®å°±æ˜¯å‡ ä¸ªæ•°æ®ç»“æ„ã€‚å¯ä»¥å›çœ‹ä¸Šé¢åœ¨å®ç° getter çš„æ—¶å€™ï¼Œç”¨åˆ°çš„é‚£å‡ ä¸ªå˜é‡"),a("code",[t._v("targetMap , depsMap , dep")]),t._v("ã€‚å…ˆæ¥çœ‹è¿™ä¸ª targetMapï¼Œå…¶å®å®ƒå°±æ˜¯ä¸€ä¸ªå…¨å±€çš„"),a("code",[t._v("WeakMap")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" targetMap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeakMap")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("è¿™ç©æ„æ˜¯ç”¨æ¥å­˜æ•°æ®å¯¹è±¡ï¼ˆtargetï¼‰å’Œ dep é›†åˆï¼ˆdepsMapï¼‰å¯¹åº”å…³ç³»çš„ã€‚å°±åƒä»£ç ä¸­å†™çš„ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" depsMap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" targetMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("depsMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœæ²¡æœ‰depsMapå°±åˆ›å»ºä¸€ä¸ª")]),t._v("\n  targetMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("depsMap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¯ä¸ªkeyéƒ½æœ‰è‡ªå·±å¯¹åº”çš„dep")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" dep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" depsMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  depsMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("å½“å¯¹ä¸€ä¸ªå¯¹è±¡ä½¿ç”¨"),a("code",[t._v("reactive")]),t._v("çš„æ—¶å€™ï¼Œå°±ä¼šæŠŠå½“å‰è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨è®¾ä¸º targetMap çš„ä¸€ä¸ªé”®ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„ Mapï¼Œä¹Ÿå°±æ˜¯ depsMapï¼Œå°†å…¶è®¾ä¸ºè¿™ä¸ªé”®çš„å€¼ã€‚å› ä¸º"),a("code",[t._v("WeakMap")]),t._v("çš„é”®æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œæ‰€ä»¥åœ¨åç»­çš„ getter æˆ–è€… setter é€»è¾‘ä¸­ç›´æ¥é€šè¿‡ target å°±èƒ½æ‰¾åˆ°å¯¹åº”çš„ depsMapã€‚æ‰€ä»¥ä½ å¯ä»¥è®¤ä¸º targetMap å­˜çš„æ˜¯ä¸€ä¸ª"),a("code",[t._v("target -> depsMap")]),t._v("çš„å¯¹åº”å…³ç³»ã€‚")]),t._v(" "),a("p",[t._v("é‚£ depsMap åˆæ˜¯ä»€ä¹ˆç©æ„ï¼Ÿå…¶å®å’Œ"),a("code",[t._v("WeakMap")]),t._v("å·®ä¸å¤šï¼Œä¹Ÿæ˜¯å­˜çš„ä¸€ä¸ªå¯¹åº”å…³ç³»ã€‚åœ¨å“åº”å¼åŸç†ä¸­ï¼Œä¸€ä¸ª key å°±å¯¹åº”è¿™ä¸€ä¸ª depï¼Œæ‰€ä»¥ depsMap å­˜çš„æ˜¯å¯¹è±¡æ‰€æœ‰çš„ key å’Œæ¯ä¸ª key å¯¹åº” dep çš„å…³ç³»ã€‚åœ¨è¿›è¡Œä¾èµ–æ”¶é›†çš„æ—¶å€™ï¼Œä¼šé€šè¿‡è¿™ä¸ª target æ‰¾åˆ°å¯¹åº”çš„ depsMapï¼Œç„¶åé€šè¿‡ keyï¼Œæ¥æ‰¾åˆ°å¯¹åº”çš„ depï¼Œæœ€ååœ¨æŠŠå½“å‰çš„"),a("code",[t._v("activeEffect")]),t._v("å­˜å…¥ dep ä¸­ã€‚")]),t._v(" "),a("p",[t._v("ä¸‹é¢æˆ‘ç”»äº†ä¸€ä¸ªç®€å•çš„ç¤ºæ„å›¾ï¼Œå…·ä½“å…³ç³»å¦‚ä¸‹ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/67b7cb85e54743968a201ca34478c430~tplv-k3u1fbpfcp-watermark.image",alt:"niubi.jpg"}})]),t._v(" "),a("h3",{attrs:{id:"å®ç°-effect"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°-effect"}},[t._v("#")]),t._v(" å®ç° effect")]),t._v(" "),a("p",[t._v("ç»ˆäºåˆ°äº†æœ€åä¸€ä¸ªè¦ç´  --- è®¢é˜…è€… effectã€‚")]),t._v(" "),a("p",[t._v("è¿™ä¹Ÿæ˜¯ Vue3 å“åº”å¼åŸç†ä¸­ï¼Œéå¸¸é‡è¦çš„ä¸€ä¸ªè§’è‰²ã€‚å› ä¸ºç»„ä»¶çš„å¾ˆå¤šå·¥ä½œéƒ½æ˜¯é è®¢é˜…è€…çš„æ‰§è¡Œæ¥é©±åŠ¨çš„ã€‚é‚£è¿™äº›è®¢é˜…è€…å…·ä½“æ˜¯æ€ä¹ˆå·¥ä½œçš„å‘¢ï¼Ÿ")]),t._v(" "),a("h4",{attrs:{id:"vue2-vue3-è®¢é˜…è€…çš„åŒºåˆ«"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue2-vue3-è®¢é˜…è€…çš„åŒºåˆ«"}},[t._v("#")]),t._v(" Vue2 / Vue3 è®¢é˜…è€…çš„åŒºåˆ«")]),t._v(" "),a("p",[t._v("Vue2 çš„è®¢é˜…è€…æ˜¯é€šè¿‡"),a("code",[t._v("Watcher")]),t._v("è¿™ä¸ªç±»å®ç°çš„ï¼Œç„¶å Dep è¿™ä¸ªç±»æœ‰ä¸€ä¸ª target çš„é™æ€å±æ€§ï¼Œç”¨æ¥è®°å½•å½“å‰æ­£åœ¨æ¿€æ´»çš„ watcherã€‚å½“åˆ›å»º "),a("code",[t._v("Watcher")]),t._v("å®ä¾‹çš„æ—¶å€™ï¼Œå®ä¾‹ä¼šå°†è‡ªèº«çš„å¼•ç”¨èµ‹å€¼ç»™è¿™ä¸ª targetï¼Œæ¸²æŸ“è¿‡ç¨‹ä¸­å‘ç”Ÿä¾èµ–æ”¶é›†çš„æ—¶å€™å°±ä¼šå°†å½“å‰çš„ Dep.target æ”¶é›†è¿›æ¥ã€‚å…¶å® Vue3 ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ï¼Œå°±æ˜¯"),a("code",[t._v("Watcher")]),t._v("å˜æˆäº†"),a("code",[t._v("effect")]),t._v("å‡½æ•°ï¼ŒDep.target å˜æˆäº†"),a("code",[t._v("activeEffect")]),t._v("è¿™ä¸ªå˜é‡ã€‚")]),t._v(" "),a("p",[t._v("åœ¨ Vue3 ä¸­é‡‡ç”¨çš„ "),a("code",[t._v("effect")]),t._v(" å‡½æ•°ï¼Œæ¥å®ç°è®¢é˜…è€…ã€‚å®ƒå…è®¸ä½ ä¼ å…¥ä¸€ä¸ªå‡½æ•°å’Œä¸€äº›é…ç½®é¡¹ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…è£…è¿‡çš„æ–°å‡½æ•°ã€‚ä¸ºäº†ä¾¿äºåŒºåˆ†ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªè¿”å›çš„æ–°å‡½æ•°ç§°ä¸º"),a("code",[t._v("reactiveEffect")]),t._v("ã€‚è¿™ä¸ª"),a("code",[t._v("reactiveEffect")]),t._v("æ‰§è¡Œæ—¶ï¼Œä¼šåœ¨ä¸ä¿®æ”¹ä¼ å…¥å‡½æ•°é€»è¾‘çš„æƒ…å†µä¸‹ï¼Œæ‰©å±•ä¸€ä¸ªæ–°çš„é€»è¾‘ --- å°†è‡ªå·±èº«èµ‹å€¼ç»™"),a("code",[t._v("activeEffect")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("åœ¨ Vue3 ä¸­æ˜¯è¿™æ ·ä¸ºç»„ä»¶åˆ›å»º"),a("code",[t._v("effect")]),t._v("æ¸²æŸ“å‡½æ•°çš„ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// instanceæ˜¯ç»„ä»¶å®ä¾‹")]),t._v("\ninstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// éœ€è¦åŒ…è£…çš„æ¸²æŸ“å‡½æ•°")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'æ¸²æŸ“ç»„ä»¶'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºå®Œå°±ç«‹å³æ‰§è¡Œ")]),t._v("\n    lazy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("å½“ä¸€ä¸ªç»„ä»¶æŒ‚è½½çš„æ—¶å€™ï¼Œä¼šé€šè¿‡è¿™ä¸ª"),a("code",[t._v("effect")]),t._v("å»åŒ…è£…æ¸²æŸ“å‡½æ•°ï¼Œç”Ÿæˆä¸€ä¸ª"),a("code",[t._v("render effect")]),t._v("å¹¶ç«‹å³æ‰§è¡Œå®ƒã€‚"),a("code",[t._v("render effect")]),t._v("åœ¨æ‰§è¡Œ"),a("code",[t._v("componentEffect")]),t._v("ä¹‹å‰ä¼šå°†"),a("code",[t._v("activeEffect")]),t._v("æŒ‡å‘è¿™ä¸ªè‡ªå·±ã€‚æ¥ç€ï¼Œåœ¨ç»„ä»¶æ¸²æŸ“è¿‡ç¨‹ä¸­è¢«è®¿é—®çš„æ•°æ®ï¼Œå°±ä¼šæ”¶é›†åˆ°è¿™ä¸ª"),a("code",[t._v("activeEffect")]),t._v("ï¼Œæ‰€ä»¥ä¸€æ—¦æ•°æ®æ›´æ–°ï¼Œå°±èƒ½è§¦å‘è§†å›¾çš„æ¸²æŸ“æ›´æ–°ã€‚")]),t._v(" "),a("p",[t._v("é‚£ä¹ˆè¿™ä¸ª"),a("code",[t._v("effect")]),t._v("å‡½æ•°æ˜¯å¦‚ä½•åšåˆ°ï¼Œåœ¨ä¸ä¾µå…¥åŸæ¥çš„ä»£ç çš„æƒ…å†µï¼ŒåŠ ä¸Šé¢å¤–é€»è¾‘çš„å‘¢ï¼Ÿ")]),t._v(" "),a("h4",{attrs:{id:"åŒ…è£…å‡½æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŒ…è£…å‡½æ•°"}},[t._v("#")]),t._v(" åŒ…è£…å‡½æ•°")]),t._v(" "),a("p",[t._v("é¦–å…ˆè®²ä¸€ä¸ªæ¦‚å¿µ --- wrapper å‡½æ•°ã€‚å®ƒæ˜¯åœ¨å‡½æ•°å¼ç¼–ç¨‹é‡Œé¢å¸¸ç”¨çš„ä¸€ä¸ªç¼–ç¨‹æ‰‹æ³•ã€‚")]),t._v(" "),a("p",[t._v("å†™ä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'run'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ç°åœ¨æˆ‘éœ€è¦è¿™ä¸ªå‡½æ•°åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œæ‰“å°å¼€å§‹æ‰§è¡Œçš„æ—¶é—´ï¼Œä½†æ˜¯ä¸èƒ½æ”¹åŸæœ‰å‡½æ•°çš„ä»£ç ã€‚æ­¤æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ wrapper å‡½æ•°ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®ç°ä¸€ä¸ªåŒ…è£…å‡½æ•°")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wrapper")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å†™éœ€è¦æ‰©å±•çš„å‰ç½®é€»è¾‘")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("arguments"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¾—åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" runAndPrintDate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wrapper")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("runAndPrintDate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¾“å‡ºç»“æœï¼š")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Fri May 07 2021 16:22:52 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// run")]),t._v("\n")])])]),a("p",[t._v("è¯¥æ–¹å¼å°±å®ç°äº†æ—¢ä¸ä¿®æ”¹åŸæ¥å‡½æ•°çš„ä»£ç ï¼Œåˆèƒ½æ‰©å±•æ–°çš„é€»è¾‘ã€‚å…¶å®"),a("code",[t._v("effect")]),t._v("å‡½æ•°å®ç°çš„åŸç†ä¹Ÿæ˜¯å¦‚æ­¤ã€‚")]),t._v(" "),a("h4",{attrs:{id:"effect-å®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#effect-å®ç°"}},[t._v("#")]),t._v(" effect å®ç°")]),t._v(" "),a("p",[t._v("effect çš„å…·ä½“å®ç°ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// effectæ‰§è¡Œæ ˆ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" effectStack "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("fn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºä¸€ä¸ªåŒ…è£…è¿‡çš„å‡½æ•°")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" effect "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createReactiveEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// lazyå¯ä»¥å†³å®šæ˜¯å¦ç«‹å³æ‰§è¡Œ")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lazy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" effect\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// createReactiveEffectå°±æ˜¯é‚£ä¸ªwrapperå‡½æ•°")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createReactiveEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("fn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("effect")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactiveEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("effectStack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("effect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ­£åœ¨æ‰§è¡Œçš„effectæ¨å…¥æ‰§è¡Œæ ˆ")]),t._v("\n        effectStack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("effect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        activeEffect "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" effect\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™é‡Œå¸Œæœ›æ‰§è¡Œå®Œæ¯•çš„effecté€€å‡ºæ‰§è¡Œæ ˆ")]),t._v("\n        effectStack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        activeEffect "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" effectStack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("effectStack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  effect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" uid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\n  effect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("raw "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fn\n  effect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" effect\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ä»¥ä¸Šä»£ç æœ‰ä¸¤ä¸ªç‚¹è¦æ³¨æ„ä¸€ä¸‹ï¼Œåˆ†åˆ«æ˜¯"),a("code",[t._v("effectStack")]),t._v("å’Œ"),a("code",[t._v("options")]),t._v("å‚æ•°ã€‚")]),t._v(" "),a("p",[a("code",[t._v("effectStack")]),t._v("æ˜¯ä¸€ä¸ªè®°å½•"),a("code",[t._v("effect")]),t._v("çš„æ‰§è¡Œæ ˆï¼Œå®ƒä¸»è¦æ˜¯è§£å†³ä¸€ä¸ª"),a("code",[t._v("effect")]),t._v("åµŒå¥—è°ƒç”¨çš„æƒ…å†µï¼Œè¿™ä¸ªæ¦‚å¿µåœ¨å®ç° computed ç« èŠ‚ä¸­ä¼šç»†è¯´ã€‚")]),t._v(" "),a("p",[t._v("é‡ç‚¹æ¥çœ‹"),a("code",[t._v("options")]),t._v("ï¼Œå› ä¸ºåœ¨ Vue ä¸­è®¢é˜…è€…çš„ç±»å‹æœ‰å¤šç§ï¼Œå®ƒä»¬åœ¨ä¸åŒçš„åº”ç”¨åœºæ™¯ä¼šå‡ºç°ä¸åŒçš„éœ€æ±‚ï¼Œæ‰€ä»¥éœ€è¦ç”¨ä¸€ä¸ª"),a("code",[t._v("options")]),t._v("æ¥é…ç½®ä¸åŒçš„æƒ…å†µã€‚å°±æ¯”å¦‚ä¸Šé¢ç»™ç»„ä»¶å®åˆ›å»º"),a("code",[t._v("render effect")]),t._v("çš„æ—¶å€™ï¼Œå°±ä¼šé…ç½®ä¸€ä¸ª"),a("code",[t._v("lazy")]),t._v("ä¸º false çš„å±æ€§ã€‚å› ä¸ºåœ¨ç»„ä»¶åˆæ¬¡æŒ‚è½½çš„æ—¶å€™ï¼Œå¸Œæœ›åœ¨åˆ›å»º"),a("code",[t._v("render effect")]),t._v("æ—¶é©¬ä¸Šæ‰§è¡Œå»æ¸²æŸ“ VNodeTreeã€‚ä½†æ˜¯æœ‰äº›åœºæ™¯ï¼Œåˆä¸éœ€è¦åœ¨åˆ›å»ºçš„æ—¶å€™å®ƒé©¬ä¸Šæ‰§è¡Œï¼Œæ¯”å¦‚åˆ›å»ºç›‘å¬å™¨æˆ–è€…è®¡ç®—å±æ€§çš„æ—¶å€™ã€‚ä½†æ˜¯ï¼Œåœ¨"),a("code",[t._v("options")]),t._v("è¿™ä¸ªé…ç½®é‡Œé¢ï¼Œæœ€é‡è¦çš„è¿˜æ˜¯"),a("code",[t._v("scheduler")]),t._v("è¿™ä¸ªå±æ€§ã€‚å¯ä»¥çœ‹åˆ°åœ¨"),a("code",[t._v("trigger")]),t._v("å‡½æ•°çš„æ‰§è¡Œä¸­æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ­¥éª¤ï¼Œå°±æ˜¯åœ¨æ‰§è¡Œ dep é‡Œé¢æ‰€æœ‰"),a("code",[t._v("effect")]),t._v("æ—¶ï¼Œä¼šåˆ¤æ–­æ˜¯å¦æœ‰"),a("code",[t._v("scheduler")]),t._v("å­˜åœ¨ï¼Œå¦‚æœæœ‰å°±æ˜¯ä¼šä½¿ç”¨"),a("code",[t._v("scheduler")]),t._v("å»è°ƒåº¦çš„æ‰§è¡Œã€‚")]),t._v(" "),a("p",[t._v("é‚£ä¸ºä»€ä¹ˆéœ€è¦"),a("code",[t._v("scheduler")]),t._v("è¿™ç§è®¾è®¡å‘¢ï¼Ÿæˆ‘ä»¬é‡ç‚¹çœ‹ä¸€ä¸‹ Vue ä¸­å¼‚æ­¥é˜Ÿåˆ—æœºåˆ¶çš„å®ç°ã€‚")]),t._v(" "),a("h2",{attrs:{id:"å®ç°å¼‚æ­¥é˜Ÿåˆ—çš„æœºåˆ¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°å¼‚æ­¥é˜Ÿåˆ—çš„æœºåˆ¶"}},[t._v("#")]),t._v(" å®ç°å¼‚æ­¥é˜Ÿåˆ—çš„æœºåˆ¶")]),t._v(" "),a("p",[t._v("å’±ä»¬å…ˆä¸ç®¡å¼‚æ­¥é˜Ÿåˆ—æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Œå…ˆæ¥çœ‹åŸå…ˆå®ç°çš„ä»£ç æœ‰æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚æ¥å†™ä¸€ä¸ªä¾‹å­ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      num"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      person"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      state\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¨¡æ‹Ÿç»„ä»¶æŒ‚è½½æ—¶ç”Ÿæˆçš„render effect")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¨¡æ‹Ÿæ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œè®¿é—®å€¼")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'æ¸²æŸ“ç»„ä»¶'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    lazy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¿®æ”¹æ•°æ®")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰“å°100æ¬¡ â€œæ¸²æŸ“ç»„ä»¶â€")]),t._v("\n")])])]),a("p",[t._v("åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¿®æ”¹äº†"),a("code",[t._v("state.person.a")]),t._v("è¿™ä¸ªå˜é‡ 100 æ¬¡ï¼Œ'æ¸²æŸ“ç»„ä»¶'å°±ä¼šè¢«æ‰“å° 100 æ¬¡ã€‚è¦çŸ¥é“æ¸²æŸ“ç»„ä»¶å…¶å®æœ‰ä¸€ä¸ªéå¸¸å¤æ‚çš„è¿‡ç¨‹ --- patchã€‚")]),t._v(" "),a("p",[t._v("è¿™è¿‡ç¨‹ä¼šåˆ›å»ºæ–°çš„ VNodeTreeï¼Œç„¶åå’Œæ—§çš„ VNodeTree è¿›è¡Œä¸€ä¸ªé€’å½’çš„æ¯”å¯¹ï¼Œæ¯”å¯¹è¿‡ç¨‹ä¸­ä¼šæ‰¾å‡ºæ“ä½œ dom çš„æœ€ä¼˜æ–¹å¼ï¼Œä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹å…¶å®æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œå®ƒéœ€è¦é€’å½’å¤„ç†å¾ˆå¤šå¾ˆå¤šäº‹æƒ…ã€‚å¦‚æœæ¯ä¿®æ”¹ä¸€æ¬¡æ•°æ®å°±æ‰§è¡Œä¸€éè¿™ä¸ªè¿‡ç¨‹ï¼Œå…¶å®æ˜¯ä¸€ç§æ€§èƒ½çš„æµªè´¹ï¼Œé‚£è¿˜ä¸å¦‚ç›´æ¥æ“ä½œ dom æ¥çš„å¿«ã€‚")]),t._v(" "),a("p",[t._v("é‚£åœ¨ Vue ä¸­æ˜¯å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜çš„å‘¢ï¼Ÿ")]),t._v(" "),a("h3",{attrs:{id:"å®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°"}},[t._v("#")]),t._v(" å®ç°")]),t._v(" "),a("p",[t._v("å› ä¸ºåœ¨ Vue ä¸­æœ‰ä¸€ç§å¼‚æ­¥é˜Ÿåˆ—çš„æœºåˆ¶ï¼Œä¼šæŠŠä½¿ç”¨è¯¥æœºåˆ¶çš„ä»»åŠ¡å…ˆç¼“å­˜èµ·æ¥ï¼Œç­‰åˆ°æ‰€æœ‰æ•°æ®éƒ½ä¿®æ”¹å®Œæ¯•ï¼Œè¿™äº›ä»»åŠ¡æ‰ä¼šè¢«æ‰§è¡Œã€‚")]),t._v(" "),a("p",[t._v("è¿™ç§æœºåˆ¶çš„æ ¸å¿ƒå°±å¦‚å®ƒçš„åå­—ï¼Œå°±æ˜¯â€œé˜Ÿåˆ—â€å’Œâ€œå¼‚æ­¥â€ã€‚æ‰€è°“â€œé˜Ÿåˆ—â€ï¼Œå°±æ˜¯ä¸€ä¸ªç¼“å­˜ä»»åŠ¡çš„æ•°ç»„ï¼Œæ‰€æœ‰é€šè¿‡è¿™ç§æœºåˆ¶è°ƒåº¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œä¼šè¢«ç¼“å­˜åˆ°é˜Ÿåˆ—ä¸­å¹¶ä¸”æ˜¯å»é‡çš„ã€‚è‡³äºâ€œå¼‚æ­¥â€å°±æ˜¯æ‰§è¡Œæ•°ç»„ä¸­ä»»åŠ¡çš„æ–¹å¼ï¼Œå®ƒä¼šæŠŠä¸€ä¸ªæ‰§è¡Œâ€œé˜Ÿåˆ—â€é‡Œå…¨éƒ¨ä»»åŠ¡çš„æ–¹æ³•æ¨å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰åˆ°è¯¥è½®å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åœ¨æ‰§è¡Œï¼Œä»¥æ­¤æ–¹å¼æ¥ä¿è¯æ‰€æœ‰çš„ä»»åŠ¡çš„â€œæ±‡æ€»â€å»¶åæ‰§è¡Œã€‚é‚£è¿™ç§æœºåˆ¶æ˜¯å¦‚ä½•å…·ä½“å®ç°çš„å‘¢ï¼Ÿ")]),t._v(" "),a("p",[t._v("å…ˆæ¥å®ç°ä¸€ä¸‹ç¼“å­˜ä»»åŠ¡çš„è¿‡ç¨‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä»»åŠ¡é˜Ÿåˆ—")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" queue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueJob")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("job")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("job"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("job"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueFlush")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueFlush")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰§è¡Œä»»åŠ¡")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ç¼“å­˜ä»»åŠ¡è¿™ä¸ªæ­¥éª¤æå®šäº†ï¼Œç°åœ¨å¯ä»¥æŠŠè¿™ä¸ª"),a("code",[t._v("queueJob")]),t._v("èµ‹å€¼ç»™"),a("code",[t._v("scheduler")]),t._v("äº†ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¨¡æ‹Ÿç»„ä»¶æŒ‚è½½æ—¶ç”Ÿæˆçš„æ¸²æŸ“effect")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'æ¸²æŸ“ç»„ä»¶'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    lazy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    scheduler"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" queueJob\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("è¿™æ ·åœ¨ä¿®æ”¹æ•°æ®çš„æ—¶å€™ï¼Œå°±ä¼šå°†å½“å‰è¿™ä¸ª"),a("code",[t._v("effect")]),t._v("å…ˆå­˜å…¥åˆ°é˜Ÿåˆ—é‡Œé¢ï¼Œå¹¶è¿˜èƒ½ä¿è¯æ¯ä¸€ä¸ª"),a("code",[t._v("effect")]),t._v("çš„å”¯ä¸€æ€§ã€‚ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨ä»€ä¹ˆæ—¶æœºå»æ‰§è¡Œ"),a("code",[t._v("queue")]),t._v("çš„ä»»åŠ¡æœ€åˆé€‚å‘¢ï¼Ÿ")]),t._v(" "),a("p",[t._v("å‡å¦‚ç›´æ¥æŠŠ"),a("code",[t._v("queueFlush")]),t._v("å†™æˆè¿™æ ·ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueFlush")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰§è¡Œä»»åŠ¡")]),t._v("\n  queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("job")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("job")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  queue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("é‚£è¿™ä¸ªé˜Ÿåˆ—å°±æ¯«æ— æ„ä¹‰äº†ï¼Œå› ä¸ºä»£ç éƒ½æ˜¯åŒæ­¥çš„åŸå› ï¼Œå³ä½¿å­˜äº†ä¹Ÿæ˜¯æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šç›´æ¥æ‰§è¡Œæ¸²æŸ“ï¼Œæ‰€ä»¥å¿…é¡»æƒ³åŠæ³•è®©æ‰§è¡Œè¿‡ç¨‹å»¶ååˆ°æ‰€æœ‰èµ‹å€¼é€»è¾‘èµ°å®Œä¹‹åã€‚è¿™å°±å¾—é‡‡ç”¨å¼‚æ­¥çš„æ–¹å¼ï¼Œè®©æ¸²æŸ“æ‰§è¡Œä»»åŠ¡å»¶åã€‚é‚£å»¶è¿Ÿåˆ°ä½•æ—¶æ‰æ˜¯æœ€å¥½çš„å‘¢ï¼Ÿå½“ç„¶æ˜¯å½“å‰å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œå¼€å§‹æ‰§è¡Œå¾®ä»»åŠ¡çš„æ—¶å€™ã€‚æ‰€ä»¥æŠŠæ‰§è¡Œæ—¶æœºæ”¾åœ¨å¾®ä»»åŠ¡ä¸­æ˜¯æœ€å¥½çš„ã€‚")]),t._v(" "),a("p",[t._v("æ¥æ”¹ä¸€ä¸‹æˆ‘ä»¬çš„ä»£ç ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä»»åŠ¡é˜Ÿåˆ—")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" queue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç”¨æ¥æ ‡è®°æ˜¯å¦å¼€å¯äº†ä¸€ä¸ªå¾®ä»»åŠ¡é˜Ÿåˆ—")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" isFlushPending "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç”¨æ¥æ ‡è®°queueä¸­çš„ä»»åŠ¡æ˜¯å¦æ­£åœ¨æ‰§è¡Œ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" isFlushing "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueJob")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("job")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("job"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("job"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueFlush")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueFlush")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("isFlushPending "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("isFlushing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    isFlushPending "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é€šè¿‡thenæ–¹æ³•å°†æ‰§è¡Œä»»åŠ¡çš„æ–¹æ³•ï¼ˆflushJobsï¼‰æ¨å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—")]),t._v("\n    Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flushJobs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰§è¡Œä»»åŠ¡")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("flushJobs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  isFlushPending "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n  isFlushing "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n  queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("job")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("job")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n  isFlushing "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("è¿™é‡Œæ¥ç†ä¸€ä¸‹ä¸Šé¢çš„é€»è¾‘ï¼Œå‡å¦‚åœ¨æŸä¸€ä¸ªäº¤äº’äº‹ä»¶ä¸­ï¼Œæ”¹å˜äº†æŸä¸ªç»„ä»¶çš„å¾ˆå¤šä¸ªæ•°æ®ã€‚è¿™äº›æ•°æ®å¯¹åº”çš„"),a("code",[t._v("trigger")]),t._v("é€»è¾‘éƒ½ä¼šè§¦å‘ï¼Œç„¶åéƒ½ä½¿ç”¨"),a("code",[t._v("scheduler")]),t._v("å»è°ƒåº¦æ‰§è¡Œå¯¹åº”"),a("code",[t._v("effect")]),t._v("ã€‚æ­¤æ—¶ç¬¬ä¸€ä¸ªæ•°æ®çš„ä¿®æ”¹æ‰§è¡Œäº†"),a("code",[t._v("queueJob")]),t._v("å°†è¯¥ç»„ä»¶çš„"),a("code",[t._v("render effect")]),t._v("æ¨å…¥äº†ä»»åŠ¡é˜Ÿåˆ—"),a("code",[t._v("queue")]),t._v("ä¸­ï¼Œç„¶åæ‰§è¡Œ"),a("code",[t._v("queueFlush")]),t._v("å°†ä»»åŠ¡åˆ·æ–°å‡½æ•°"),a("code",[t._v("flushJobs")]),t._v("æ¨å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå¹¶è¿›è¡Œä¸€ä¸ªæ ‡è®°ï¼Œè¡¨ç¤ºåœ¨å¾®ä»»åŠ¡ä¸­å·²ç»æ¨å…¥äº†ä¸€ä¸ªåˆ·æ–°ä»»åŠ¡çš„å‡½æ•°ã€‚è¿™æ ·ç¬¬äºŒæ¬¡ï¼Œä¹ƒè‡³ç¬¬ n æ¬¡æ•°æ®çš„ä¿®æ”¹éƒ½ä¸ä¼šæŠŠ"),a("code",[t._v("flushJobs")]),t._v("æ¨å…¥åˆ°å¾®ä»»åŠ¡ä¸­ï¼Œè€Œä¸”"),a("code",[t._v("queue")]),t._v("ä¸­ä¹Ÿåªä¼šæœ‰ä¸€ä¸ª"),a("code",[t._v("render effect")]),t._v("ã€‚ä¸€æ—¦æœ¬æ¬¡å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ ¹æ® js çš„äº‹ä»¶å¾ªç¯æœºåˆ¶ï¼Œå¼€å§‹æ‰§è¡Œå¾®ä»»åŠ¡ï¼Œå°±æŠŠ"),a("code",[t._v("flushJobs")]),t._v("å‹å…¥æ‰§è¡Œæ ˆä¸­ï¼Œè¿™å°±æ˜¯å¤šæ¬¡æ•°æ®ä¿®æ”¹ï¼Œåªæ¸²æŸ“ä¸€æ¬¡çš„å·¥ä½œæµç¨‹ã€‚")]),t._v(" "),a("p",[t._v("è¿™é‡Œæ¥ç®€å•ç”»ä¸€ä¸ªæµç¨‹å›¾ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9b017dcb8481476d95478abf0d89f1ac~tplv-k3u1fbpfcp-watermark.image",alt:"WechatIMG1607.png"}})]),t._v(" "),a("p",[t._v("è¿™è½®äº¤äº’äº‹ä»¶æ‰§è¡Œå®Œæ¯•ï¼Œjs çš„æ‰§è¡Œæ ˆå¼€å§‹å‘å¾®ä»»åŠ¡é˜Ÿåˆ—æ‹¿ä»»åŠ¡æ‰§è¡Œï¼Œæ‹¿åˆ°"),a("code",[t._v("flushJobs")]),t._v("å¹¶æ‰§è¡Œï¼Œå°†"),a("code",[t._v("queue")]),t._v("ä¸­å…¨éƒ¨çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ•´ä¸ªå¼‚æ­¥æ›´æ–°çš„æµç¨‹å°±èµ°å®Œäº†ã€‚")]),t._v(" "),a("h3",{attrs:{id:"æµ‹è¯•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æµ‹è¯•"}},[t._v("#")]),t._v(" æµ‹è¯•")]),t._v(" "),a("p",[t._v("è¿™é‡Œæ”¹ä¸€ä¸‹åŸæ¥åˆ›å»ºçš„ effect:")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¨¡æ‹Ÿç»„ä»¶æŒ‚è½½æ—¶ç”Ÿæˆçš„æ¸²æŸ“effect")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¨¡æ‹Ÿæ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œè®¿é—®å€¼")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'æ¸²æŸ“ç»„ä»¶'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    lazy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    scheduler"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" queueJob\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("ç»§ç»­ä½¿ç”¨ä¸Šé¢çš„ä¾‹å­æ¥è¿è¡Œï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¿®æ”¹å€¼")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ç»“æœï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d7f53d97123d4eb688bae93b0cd97105~tplv-k3u1fbpfcp-watermark.image",alt:"46136dbf5050f717b1bd3562137f6ae.png"}})]),t._v(" "),a("p",[t._v("éå¸¸ niceï¼Œå°±ç®—è¿™ä¸ªå€¼è¢«æ”¹äº† 100 æ¬¡ï¼Œä½†æ˜¯ä¹Ÿåªä¼šæ¸²æŸ“æœ€åä¸€æ¬¡ä¿®æ”¹çš„çŠ¶æ€ã€‚")]),t._v(" "),a("h2",{attrs:{id:"å®ç°-watch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°-watch"}},[t._v("#")]),t._v(" å®ç° watch")]),t._v(" "),a("p",[t._v("åœ¨å“åº”å¼åŸç†ä¸­æœ‰è¯´åˆ°ï¼Œåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­æ•°æ®å¯ä»¥è‡ªå·±å»æ”¶é›†æ¸²æŸ“å‡½æ•°"),a("code",[t._v("render effect")]),t._v("ï¼Œä¸€æ—¦æ•°æ®æ›´æ–°å°±ä¼šè‡ªåŠ¨è§¦å‘å†æ¬¡æ¸²æŸ“ã€‚é‚£æœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•è®©æˆ‘ä»¬æ‰‹åŠ¨å»ç»™æŸäº›æ•°æ®å¢åŠ äº‹ä»¶ï¼Œåœ¨æ•°æ®å˜æ›´çš„æ—¶å€™è‡ªåŠ¨å»æ‰§è¡Œå‘¢ï¼Ÿ")]),t._v(" "),a("p",[t._v("Watch è¿™ä¸ª API å°±è§£å†³äº†è¿™ä¸ªéœ€æ±‚ã€‚å®ƒå…è®¸æˆ‘ä»¬å»ç›‘å¬å“åº”å¼çš„æ•°æ®ï¼Œç„¶ååœ¨æ•°æ®å˜æ›´æ—¶æ‰§è¡Œå›è°ƒã€‚å®ƒæ˜¯ä¾èµ–äº"),a("code",[t._v("effect")]),t._v("å»å®ç°çš„ï¼Œå› ä¸ºè¢«"),a("code",[t._v("effect")]),t._v("åŒ…è£…è¿‡çš„å‡½æ•°å¯ä»¥åœ¨æ‰§è¡Œå‰ï¼Œå°†å½“å‰çš„"),a("code",[t._v("activeEffect")]),t._v("æŒ‡å‘è‡ªå·±ï¼Œæ‰€ä»¥é€šè¿‡"),a("code",[t._v("watch")]),t._v("åˆ›å»ºçš„"),a("code",[t._v("watch effect")]),t._v("åœ¨æ‰§è¡Œæ—¶ä¼šå¯¹éœ€è¦ç›‘å¬çš„å€¼è¿›è¡Œä¸€æ¬¡ getï¼Œè¿™æ ·è¢«ç›‘å¬çš„æ•°æ®å°±å¯ä»¥æ”¶é›†åˆ°è¿™ä¸ª"),a("code",[t._v("watch effect")]),t._v("ï¼Œåœ¨æ•°æ®å˜åŠ¨æ—¶ï¼Œå°±ä¼šè§¦å‘"),a("code",[t._v("scheduler")]),t._v("ä¸­çš„å›è°ƒã€‚")]),t._v(" "),a("p",[t._v("ä»£ç å®ç°ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("getter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" getter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" _getter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" getter\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" oldValue\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n   * æ‰§è¡Œå›è°ƒ\n   * è®¡ç®—æ–°çš„å€¼ï¼Œç¼“å­˜æ—§çš„å€¼\n   */")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("job")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" newValue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    oldValue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newValue\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºwatch effect")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" runner "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_getter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    lazy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("scheduler")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¼‚æ­¥è°ƒåº¦çš„æ–¹å¼å»æ‰§è¡Œ")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueJob")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("job"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  oldValue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("runner")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("æ¥æµ‹è¯•ä¸€ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      num"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("newVal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'è§¦å‘ç›‘å¬å™¨'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newVal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      state\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¨¡æ‹Ÿç»„ä»¶æŒ‚è½½æ—¶ç”Ÿæˆçš„æ¸²æŸ“effect")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¨¡æ‹Ÿæ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œè®¿é—®å€¼")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'æ¸²æŸ“ç»„ä»¶'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    lazy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    scheduler"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" queueJob\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nvm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\n")])])]),a("p",[t._v("çœ‹ä¸€ä¸‹ç»“æœï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e040e670a55d4fab953d9399036f7e79~tplv-k3u1fbpfcp-watermark.image",alt:"4f8c08f76bb3b10046660d9e9e1f945.png"}})]),t._v(" "),a("p",[t._v("watch çš„å®ç°å°±æå®šäº†ã€‚")]),t._v(" "),a("h2",{attrs:{id:"å®ç°-computed"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°-computed"}},[t._v("#")]),t._v(" å®ç° computed")]),t._v(" "),a("p",[t._v("è®¡ç®—å±æ€§è¿™ä¸ª API æ˜¯ Vue ä¸­çš„ä¸€ä¸ªç‰¹è‰²ã€‚å®ƒå¯ä»¥åˆ›å»ºä¸€ä¸ª computed å¯¹è±¡ï¼Œç„¶åå†…éƒ¨çš„ value å¯ä»¥æ ¹æ®ä¾èµ–çš„æ•°æ®è¿›è¡Œè®¡ç®—è·å–å¾—æ–°çš„å€¼ï¼Œå¹¶è§¦å‘é¡µé¢çš„æ¸²æŸ“ã€‚")]),t._v(" "),a("p",[t._v("è¿™æ¬¡çœ‹ä¸€ä¸‹å®Œæ•´çš„ä»£ç å®ç°ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" _getter\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" _setter\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" _computed\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" _value\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" _dirty "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" options "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    _getter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("_setter")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("warn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'computed _ is readonly'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    _getter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get\n    _setter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºcomputed effect")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" runner "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_getter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    lazy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("scheduler")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("_dirty"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“ä¾èµ–çš„å“åº”å¼æ•°æ®å‘ç”Ÿå˜åŒ–")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¼šå°†computedæ ‡è®°ä¸ºè„å€¼")]),t._v("\n        _dirty "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("trigger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_computed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'value'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  _computed "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœæ•°æ®æ˜¯è„æ‰é‡æ–°è®¡ç®—")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_dirty"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        _value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("runner")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        _dirty "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("track")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_computed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'value'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" _value\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("newValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_setter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" _computed\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("computed çš„åŸç†å’Œå®ç°ï¼Œå¯èƒ½ç†è§£èµ·æ¥ä¼šæ¯”è¾ƒéº»çƒ¦ä¸€ç‚¹ï¼Œä¹Ÿæ¯”è¾ƒç»•ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ç›´æ¥æ¥è®²å·²ç»å†™å¥½çš„ä»£ç ã€‚ä¸Šé¢çš„ä»£ç ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šæ ‡å‡†åŒ–å‚æ•°ï¼Œåˆ›å»º runner å‡½æ•°ï¼Œåˆ›å»º computed å¯¹è±¡å¹¶è¿”å›ã€‚")]),t._v(" "),a("p",[t._v("æ ‡å‡†åŒ–å‚æ•°å°±æ˜¯å°†ç”¨æˆ·ä¼ å…¥ getter çš„ä¸åŒæƒ…å†µåšäº†å¤„ç†ï¼Œå› ä¸ºè¯¥ API æ˜¯å…è®¸ç”¨æˆ·ä¼ å…¥ä¸€ä¸ªå•ç‹¬çš„ getterï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªåŒ…å« getter å’Œ setter çš„å¯¹è±¡çš„ã€‚è¿™é‡Œæˆ‘ä»¬é‡ç‚¹æ¥çœ‹ runner å‡½æ•°ï¼Œå’Œåˆ›å»ºçš„ computed å¯¹è±¡ã€‚")]),t._v(" "),a("h3",{attrs:{id:"runner-å‡½æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#runner-å‡½æ•°"}},[t._v("#")]),t._v(" runner å‡½æ•°")]),t._v(" "),a("p",[t._v("runner å‡½æ•°æ˜¯å¯¹ getter çš„å°è£…ã€‚å®ƒæ‰§è¡Œæ—¶ä¼šæ”¹å˜"),a("code",[t._v("actvieEffect")]),t._v("æŒ‡å‘è‡ªèº«ï¼Œç„¶åæ‰§è¡Œ getter è®¡ç®—æ–°çš„å€¼ï¼Œè®© getter å‡½æ•°å†…ä¾èµ–çš„å“åº”å¼æ•°æ®æ”¶é›†åˆ° runnerã€‚åœ¨è¿™äº›æ•°æ®å˜åŒ–æ—¶ï¼Œä¼šæ‰§è¡Œ runner èº«ä¸Šçš„ schedulerã€‚")]),t._v(" "),a("h3",{attrs:{id:"computed-å¯¹è±¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#computed-å¯¹è±¡"}},[t._v("#")]),t._v(" computed å¯¹è±¡")]),t._v(" "),a("p",[t._v("è¿™ä¸ªå¯¹è±¡ç»´æŠ¤äº†ä¸€ä¸ª value å€¼ï¼Œå½“ computed çš„ value åœ¨æ¸²æŸ“æ—¶è¢«è®¿é—®ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ")]),t._v(" "),a("p",[t._v("å› ä¸ºåˆå§‹åŒ–çš„æ—¶å€™ dirty é»˜è®¤æ˜¯ trueï¼Œæ‰€ä»¥ä¼šæ‰§è¡Œ runner æ¥è®¡ç®—æ–°çš„å€¼å¹¶ä¸”è®© getter ä¸­ä¾èµ–çš„æ•°æ®æ”¶é›†åˆ° runnerï¼Œæ¥ç€æ˜¯"),a("code",[t._v("track(_computed, 'value')")]),t._v("ï¼Œè®© computed çš„ value æ”¶é›†"),a("code",[t._v("actvieEffect")]),t._v("ï¼Œå› ä¸ºè®¿é—® value æ˜¯å‘ç”Ÿåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œæ‰€ä»¥ value æ”¶é›†çš„æ˜¯æ¸²æŸ“å‡½æ•°"),a("code",[t._v("render effect")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("ç°åœ¨æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("getter ä¸­ä¾èµ–çš„æ•°æ®æ”¶é›†åˆ° runner çš„ä½œç”¨æ˜¯ä»€ä¹ˆ")]),t._v(" "),a("li",[t._v("ä¸ºä»€ä¹ˆæ‰§è¡Œå®Œ runner åï¼Œcomputed è¿˜èƒ½æ”¶é›†åˆ° "),a("code",[t._v("render effect")])])]),t._v(" "),a("p",[t._v("ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚å½“ä¾èµ–çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ä¼šæ‰§è¡Œ runner çš„ scheduler ä¸­çš„é€»è¾‘ï¼Œå®ƒæ˜¯å…ˆå°† dirty æ ‡è®°ä¸º true æ¥å‘Šè¯‰ computed è¿™æ˜¯ä¸€ä¸ªè„å€¼ï¼Œå¹¶ä¸ä¼šé©¬ä¸Šå»é‡æ–°è®¡ç®—æ–°çš„å€¼ï¼Œå¹¶ä¸”ä¼šå»è§¦å‘æ¸²æŸ“æ›´æ–°ã€‚ç­‰åˆ°å†æ¬¡æ¸²æŸ“æ—¶è®¿é—®åˆ° computed æ—¶ï¼Œå‘ç° dirty æ˜¯ trueï¼Œå°±ä¼šé‡æ–°è¿›è¡Œè®¡ç®—ã€‚")]),t._v(" "),a("p",[t._v("ç¬¬äºŒä¸ªé—®é¢˜ã€‚è™½ç„¶ computed çš„è®¿é—®æ˜¯å‘ç”Ÿåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œå½“å‰çš„"),a("code",[t._v("actvieEffect")]),t._v("æ˜¯"),a("code",[t._v("render effect")]),t._v("ã€‚ä½†æ˜¯æ‰§è¡Œ runner çš„æ—¶å€™ï¼Œrunner å·²ç»å°†å½“å‰çš„"),a("code",[t._v("actvieEffect")]),t._v("æŒ‡å‘è‡ªå·±äº†ï¼Œä¸ºä»€ä¹ˆåç»­çš„"),a("code",[t._v("track(_computed, 'value')")]),t._v("æ”¶é›†çš„æ˜¯ "),a("code",[t._v("render effect")]),t._v("å‘¢ï¼Ÿ")]),t._v(" "),a("p",[t._v("å› ä¸ºå¯¹äºè¿™ç§"),a("code",[t._v("effect")]),t._v("åµŒå¥—ä½¿ç”¨çš„æƒ…å†µï¼ŒVue è®¾è®¡äº†ä¸€ä¸ª"),a("code",[t._v("effectStack")]),t._v("ã€‚å¯ä»¥åœ¨å›çœ‹ä¸€ä¸‹"),a("code",[t._v("effect")]),t._v("ç« èŠ‚çš„ä»£ç :")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("effectStack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("effect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ­£åœ¨æ‰§è¡Œçš„effectæ¨å…¥æ‰§è¡Œæ ˆ")]),t._v("\n    effectStack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("effect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    activeEffect "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" effect\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™é‡Œå¸Œæœ›æ‰§è¡Œå®Œæ¯•çš„effecté€€å‡ºæ‰§è¡Œæ ˆ")]),t._v("\n    effectStack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    activeEffect "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" effectStack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("effectStack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("code",[t._v("effect")]),t._v("çš„æ‰§è¡Œä¼šæŠŠè‡ªå·±æ¨å…¥"),a("code",[t._v("effect")]),t._v("çš„æ‰§è¡Œæ ˆå¹¶å°†"),a("code",[t._v("actvieEffect")]),t._v("æŒ‡å‘è‡ªå·±ï¼Œå½“å®ƒæ‰§è¡Œå®Œåï¼Œå°±ä¼šå°†è‡ªå·±é€€å‡ºæ ˆï¼Œå¹¶"),a("code",[t._v("actvieEffect")]),t._v("ä¼šæ‰§è¡ŒæŒ‡å‘æ ˆé¡¶ï¼Œä¹Ÿå°±ä¸Šä¸€ä¸ª"),a("code",[t._v("effect")]),t._v("ã€‚è¿™ä¸ªè®¾è®¡å°±å¾ˆå¥½è§£å†³äº†"),a("code",[t._v("effect")]),t._v("åµŒå¥—è°ƒç”¨çš„æƒ…å†µã€‚")]),t._v(" "),a("p",[t._v("è¿™é‡Œæ¥å‡è®¾ä¸€ä¸ªæƒ…å†µã€‚å½“ runner æ‰§è¡Œå®Œæ¯•ï¼Œå¦‚æœæ²¡æœ‰å°†å½“å‰çš„"),a("code",[t._v("actvieEffect")]),t._v("é€€å›åˆ°ä¸Šä¸€ä¸ª"),a("code",[t._v("effect")]),t._v("ï¼Œé‚£åœ¨ computed æ”¶é›†çš„æ—¶å€™å°±æ˜¯æ”¶é›†åˆ° runner äº†ã€‚è¿™å°±æ˜¯ä¸€ä¸ªé”™è¯¯çš„ä¾èµ–æ”¶é›†ï¼Œæœ¬æ¥æ­£å¸¸çš„é€»è¾‘åº”è¯¥æ˜¯ï¼šä¾èµ–æ•°æ®æ”¶é›† runnerï¼Œcomputed æ”¶é›†æ¸²æŸ“å‡½æ•°ï¼Œè¿™æ ·ä¾èµ–æ•°æ®è¢«ä¿®æ”¹æ‰èƒ½å‘Šè¯‰ computedï¼Œå¹¶è§¦å‘ computed æ”¶é›†åˆ°çš„æ¸²æŸ“å‡½æ•°å»é‡æ–°æ¸²æŸ“ï¼Œä½†æ˜¯ç”±äº runner æ‰§è¡Œå®Œæ²¡æœ‰æ­£ç¡®é€€å‡ºæ ˆï¼Œå°±ä¼šå¯¼è‡´ computed æ²¡æœ‰æ¸²æŸ“å‡½æ•°å¯ä»¥è§¦å‘ã€‚")]),t._v(" "),a("h2",{attrs:{id:"å®ç°-watcheffect"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°-watcheffect"}},[t._v("#")]),t._v(" å®ç° watchEffect")]),t._v(" "),a("p",[t._v("watchEffect çš„å®ç°å°±ç›¸å¯¹æ¯”è¾ƒç®€å•äº†ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("watchEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    scheduler"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" queueJob\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("è¿™ API æ›´åƒæ˜¯"),a("code",[t._v("effect")]),t._v("çš„ä¸€ä¸ªå°è£…ï¼Œå®ƒä¼šç«‹å³æ‰§è¡Œä¼ å…¥è¿›æ¥çš„å›è°ƒå‡½æ•°ï¼Œå¦‚æœå›è°ƒå‡½æ•°ä¸­æœ‰ä½¿ç”¨åˆ°å“åº”å¼çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®å°±ä¼šæ”¶é›†åˆ°è¿™ä¸ª"),a("code",[t._v("watchEffect")]),t._v("ï¼Œæ•°æ®å˜æ›´å°±è§¦å‘æ‰§è¡Œå®ƒã€‚")]),t._v(" "),a("h2",{attrs:{id:"æœ€å"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æœ€å"}},[t._v("#")]),t._v(" æœ€å")]),t._v(" "),a("p",[t._v("ç¬¬ä¸€æ¬¡å†™è¿™ç§è¶…é•¿ç¯‡çš„æ–‡ç«  ğŸ˜‚ã€‚æ„Ÿè§‰è‡ªå·±åœ¨é€»è¾‘æ¢³ç†ä¸Šè¿˜æ˜¯æœ‰å¾ˆå¤šæ¬ ç¼ºï¼Œå¯èƒ½é‡Œé¢æœ‰äº›ä¸œè¥¿è®²çš„ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå¦‚æœå•¥è¯´çš„ä¸å¯¹ï¼Œæˆ–è€…è®²çš„ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå¸Œæœ›å¤§ä½¬ä»¬èƒ½åœ¨è¯„è®ºåŒºæŒ‡ç‚¹ä¸€ä¸‹ã€‚å¦‚æœå¯¹ä½ ç¨å¾®æœ‰é‚£ä¹ˆä¸€ç‚¹ç‚¹å¸®åŠ©çš„è¯ï¼Œèƒ½å¦ç‚¹èµå…³æ³¨ä¸€æ³¢ï¼Œæˆ‘ä¼šç»§ç»­åŠªåŠ›çš„ã€‚")])])}),[],!1,null,null,null);s.default=e.exports}}]);